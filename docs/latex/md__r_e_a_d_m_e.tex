This is the program for the second assignment of the course Research Track 1 at the University of Genoa. Made by Marco Meschini S6273938\hypertarget{md__r_e_a_d_m_e_autotoc_md1}{}\doxysection{Environment and goal}\label{md__r_e_a_d_m_e_autotoc_md1}
The environment used in this project is a 2D simulation in Gazebo. The simulated environment features walls and objects, and within it, a robot is programmed to navigate. In addition to Gazebo, also Rviz was used; this last tool is used for R\+OS visualization, allowing the user to simulate the model and obtaining the robot sensor information. The figure below shows the initial configuration of the robot and the environment in Gazebo.

 

The objective is for the robot to reach a user-\/specified target point. The environment and the algorithm governing the robot\textquotesingle{}s movements have already been implemented and can be referenced from the existing project \href{https://github.com/CarmineD8/assignment_2_2023}{\texttt{ documentation}}.\hypertarget{md__r_e_a_d_m_e_autotoc_md2}{}\doxysection{How to run the program}\label{md__r_e_a_d_m_e_autotoc_md2}
Before starting is necessary to install R\+OS, to do so follow the instruction on \href{https://wiki.ros.org/ROS/Installation}{\texttt{ R\+OS wiki}} (for the simulation was used the Noetic version). Then, it is necessary to setup the workspace and create a package called {\itshape assignment\+\_\+2\+\_\+2023}. In order to run the script, clone the folder inside the package (ensure not to include the Git project folder within the package) and start the roscore by using the following command\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$ roscore}
\end{DoxyCode}


Finally, to start the simulation is possible to use the following command\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$ roslaunch assignment\_2\_2023 simulation.launch}
\end{DoxyCode}


(If encountering an error with the command, consider closing the terminal and reopening it). Following this step, Gazebo and Rviz are expected to render the simulation. Furthermore, each node responsible for implementing the motion algorithm and the server is initiated.\hypertarget{md__r_e_a_d_m_e_autotoc_md3}{}\doxysection{Code structure and functionality}\label{md__r_e_a_d_m_e_autotoc_md3}
\hypertarget{md__r_e_a_d_m_e_autotoc_md4}{}\doxysubsection{Bug0 algorithm for motion planning}\label{md__r_e_a_d_m_e_autotoc_md4}
The robot employs a simple yet effective algorithm for navigation in unknown environments. The algorithm consists of the following steps\+:


\begin{DoxyEnumerate}
\item {\bfseries{Move towards goal\+:}} obtained the coordinates of the goal point, the robots starts moving towards it.
\item {\bfseries{Obstacle detection and following\+:}} in case of an obstacle along the path, the robot navigates along its contours until reaching a point where it can resume its path towards the goal.
\end{DoxyEnumerate}

The algorithm iterates until the robot successfully reaches its goal.\hypertarget{md__r_e_a_d_m_e_autotoc_md5}{}\doxysubsection{Action client and interface}\label{md__r_e_a_d_m_e_autotoc_md5}
The whole program is structured in 3 nodes\+: 
\begin{DoxyEnumerate}
\item Client\+: this one implements an Action client using the Action\+Lib library from R\+OS. It is used to manage the interaction between the server and the user and to send the goal to the robot. The first part implements an interface to interact with the user and decide which action to perform. The possible actions are\+: set the target coordinates, cancel the actual target, or exit the program. The script is also responsible to retrieve the information about the actual position and velocity of the robot from the \textquotesingle{}/odom\textquotesingle{} topic. Then, it publishes them on the topic \textquotesingle{}/actual\+\_\+info\textquotesingle{}, making them accessible for other nodes within the system. 
\item Node B\+: it subscribes to the \textquotesingle{}/reaching\+\_\+goal/goal\textquotesingle{} topic, updating global variables x and y with the coordinates received from the message. It acts as a service server, providing a service named \char`\"{}last\+\_\+coordinates\char`\"{} that responds with the last set x and y coordinates.  
\item Node C\+: it implements a service server to relay information about the robot\textquotesingle{}s distance from the target and its average velocity. The script collects real-\/time data on the robot\textquotesingle{}s position and velocities through the \textquotesingle{}\textbackslash{}robot\+Info\textquotesingle{} topic, where messages are published by the client. Additionally, it retrieves target coordinates using the service implemented in Node B. To formulate its service response, the script computes the distance and the average speed. Notably, the speed calculation incorporates an averaging window, the size of which, is determined by a server parameter, set from the launch file. To achieve this, a First-\/\+In-\/\+First-\/\+Out (F\+I\+FO) buffer is created. Velocities from the received messages are continually inserted into this buffer and then the average speed is computed using the specified averaging window size.  
\end{DoxyEnumerate}\hypertarget{md__r_e_a_d_m_e_autotoc_md6}{}\doxysection{Pseudocode of client node}\label{md__r_e_a_d_m_e_autotoc_md6}

\begin{DoxyCode}{0}
\DoxyCodeLine{Import necessary libraries and namespaces}
\DoxyCodeLine{}
\DoxyCodeLine{Initialize global variables \textcolor{keywordflow}{for} coordinates, flags, and a mutex \textcolor{keywordflow}{for} data protection}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{client_8cpp_ade64b529d481df36d56216e570ab4d08}{interface}}() \{     }
\DoxyCodeLine{    \textcolor{keywordflow}{while} (programIsNotExited) \{}
\DoxyCodeLine{         Display a menu to the user to set target, cancel target, or exit}
\DoxyCodeLine{         Take user input and perform the corresponding action}
\DoxyCodeLine{         If(setTarget)\{}
\DoxyCodeLine{           ask \textcolor{keywordflow}{for} \mbox{\hyperlink{client_8cpp_af88b946fb90d5f08b5fb740c70e98c10}{x}} and \mbox{\hyperlink{client_8cpp_ab927965981178aa1fba979a37168db2a}{y}} coordinates within a valid range\}}
\DoxyCodeLine{         If(cancelTarget)\{}
\DoxyCodeLine{           set the cancel flag to \textcolor{keyword}{true}\}}
\DoxyCodeLine{         If(exit)\{}
\DoxyCodeLine{           shut down the ROS node and set the exitProgram flag to \textcolor{keyword}{true}\}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{client_8cpp_afaa5fc62bcc988d7c23627d26cb1e32a}{OdometryCallback}}(msg) \{}
\DoxyCodeLine{     Extract position and velocity from the \textcolor{stringliteral}{'/odom'} topic}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main() \{}
\DoxyCodeLine{     Initialize the ROS node}
\DoxyCodeLine{     Subscribe to the \textcolor{stringliteral}{'/odom'} topic to get position and velocity}
\DoxyCodeLine{     Advertise on the \textcolor{stringliteral}{'actual\_info'} topic to publish robot information}
\DoxyCodeLine{     Wait \textcolor{keywordflow}{for} the action server to start}
\DoxyCodeLine{     Create a \textcolor{keyword}{new} thread to run the \textcolor{stringliteral}{'interface'} \textcolor{keyword}{function}}
\DoxyCodeLine{}
\DoxyCodeLine{     \textcolor{keywordflow}{while} (programIsNotExited) \{}
\DoxyCodeLine{        If(cancel)\{}
\DoxyCodeLine{         check \textcolor{keywordflow}{if} there is an active goal, \textcolor{keywordflow}{if} yes, cancel it\}}
\DoxyCodeLine{        If(goalNotSent)\{}
\DoxyCodeLine{           send a \textcolor{keyword}{new} goal to the action server\}}
\DoxyCodeLine{         Publish the current position and velocity on the \textcolor{stringliteral}{'actual\_info'} topic}
\DoxyCodeLine{         If(reachedGoal and notPublished)\{}
\DoxyCodeLine{           print the result\}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{\}}
\end{DoxyCode}
\hypertarget{md__r_e_a_d_m_e_autotoc_md7}{}\doxysection{How to use the program}\label{md__r_e_a_d_m_e_autotoc_md7}
After having start the whole simulation with the command shown above is possible to set the target from the interface that will show on the terminal. Then, it\textquotesingle{}s also possible to cancel the actual target or exit. To retrieve the information about target is possible to open another terminal window and write\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$ rosservice call last\_coodrinates}
\end{DoxyCode}


Finally, to obtain the actual coordinates and average velocities it\textquotesingle{}s possible to use\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$ rosservice call robotInfoSrv}
\end{DoxyCode}
\hypertarget{md__r_e_a_d_m_e_autotoc_md8}{}\doxysection{Further improvments}\label{md__r_e_a_d_m_e_autotoc_md8}
The robot demonstrates its capability to navigate within the environment and reach user-\/selected goal coordinates. However, there is an improvement that can be done. In fact, the current speed of the robot is notably slow, attributed to both a modest actual speed and the absence of an algorithm that allows the robot to reaches the goal finding the shortest path. So, enhancing the speed and the algorithm efficiency would contribute to optimizing the robot\textquotesingle{}s performance in reaching its goals. 